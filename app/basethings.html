
// Implementation of base digital output class
// At creation, is initalized as : 
  socket = io.connect('http://localhost:8080');
<polymer-element name="digital-output" style="background-color: {{color}}"  >
	
	<template >
		
		<style>
			:host {
				display:inline-block;
				width: 40px ;
				height: 40px;
				border: 3px solid rgb(205,205,210);
				transition: background-color 0.3s ease-in, border-color 0.3s ease-in;
				-webkit-transition: background-color 0.3s ease-in, border-color 0.3s ease-in; 
			}
		</style>
	</template>

	<script>
		Polymer('digital-output', {

			value: 0, 
			id : 0, 
			pin : 1,
			color: 'red',
		
			// When element is created, listens to proper entry in database based on
			// {id, pin} pair	
			created: function(){
				this.super();
				console.log('created Digital Output');
				$(this).css({'background-color':this.color});
				var that = this;
				socket.on('digitalWrite', function (data) {
					console.log('caught digitla write');
				    console.log(data);
				    (that.value =  !that.value);

				});
				var data = {
					pin: that.pin, 
					id: that.id, 
					type : 'output'
				}
				socket.emit('initPin', {msg:data});
			},
			colorChanged: function(){
				$(this).css({'background-color':this.color});
			}, 

			//For value change, update styling of element and send
			//Digital Write msg to corresponding physical LED

			valueChanged: function(){
				var that = this;
				if (this.value == 0){
					$(this).css({'background-color':'rgb(50,60,70)'});
					$(this).css({'border-color':'black'});
					socket.emit('writeToPin', {
						msg:'digitalWrite', 
						pin: that.pin, 
						id: that.id, 
						value : 0
					});
				} else {
					$(this).css({'background-color':this.color});
					$(this).css({'border-color':'rgb(200,0,0'});
					socket.emit('writeToArduino', {
						msg:'digitalWrite', 
						pin: that.pin, 
						id: that.id, 
						value : 1
					})

				}
			}
		});
	</script>

</polymer-element>

